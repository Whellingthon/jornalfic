<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boletim FIC Empresa • Outubro/2025 • SENAI Pindamonhangaba</title>
  <meta name="description" content="Boletim mensal de ações corporativas do SENAI Pindamonhangaba (CFP 3.60) – Edição Outubro/2025." />

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- AOS (Animate on Scroll) -->
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  <!-- Swiper for carousels -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
<link rel="icon" href="favicon.ico" />
<link rel="stylesheet" href="css/style.css" />
  <style>
    /* =================================== */
/* CORREÇÕES GERAIS MODO ESCURO      */
/* =================================== */

/* --- Textos genéricos --- */
[data-theme="dark"] .text-secondary,
[data-theme="dark"] .text-muted,
[data-theme="dark"] .link-secondary {
  color: var(--muted) !important;
}

[data-theme="dark"] .link-secondary:hover {
  color: var(--text) !important;
}

/* --- Fundos (ex: KPIs) --- */
[data-theme="dark"] .bg-light {
  background-color: var(--bg-soft) !important;
}

/* --- Formulários (Busca) --- */
[data-theme="dark"] .form-control {
  background-color: var(--card);
  color: var(--text);
  border-color: var(--border-soft);
}

[data-theme="dark"] .form-control::placeholder {
  color: var(--muted);
}

/* --- Botões de Filtro --- */
[data-theme="dark"] .btn-outline-secondary {
  color: var(--muted);
  border-color: var(--border-soft);
}

[data-theme="dark"] .btn-outline-secondary:hover {
  color: var(--text);
  background-color: var(--bg-soft);
  border-color: var(--border-soft);
}

/* --- Badge de Empresa nos Cards --- */
[data-theme="dark"] .badge.text-bg-light.border {
    background-color: var(--bg-soft) !important;
    color: var(--text) !important;
    border-color: var(--border-soft) !important;
}
    /* =================================== */
/* Correção NAV-BAR MODO ESCURO      */
/* =================================== */

/* Altera a cor do Título/Brand (SENAI Pinda • FIC Empresa) */
[data-theme="dark"] .navbar-brand {
  color: var(--text);
}

/* Altera a cor dos links (Resumo, Ações, etc.) */
[data-theme="dark"] .nav-link {
  color: var(--muted); /* Usa a cor 'muted' para links normais */
}

/* Altera a cor do link no HOVER/FOCUS */
[data-theme="dark"] .nav-link:hover,
[data-theme="dark"] .nav-link:focus {
  color: var(--text); /* Usa a cor principal no hover */
}

/* Altera o ícone do "hambúrguer" (toggler) para branco */
[data-theme="dark"] .navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(242, 242, 242, 0.75)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

/* Opcional: Altera a borda do botão toggler */
[data-theme="dark"] .navbar-toggler {
  border-color: rgba(255, 255, 255, 0.1);
}
    /* Adaptação do texto do header no modo escuro */
.hero, .hero h1, .hero p, .hero .lead, .hero .text-secondary {
  color: var(--text) !important;
}

[data-theme="dark"] .hero .text-secondary {
  color: #ddd !important; /* suaviza o contraste no dark */
}

    :root{
      --brand:#e30613; /* vermelho SENAI-like */
      --text:#1e1e1e;
      --muted:#6c757d;
      --bg:#ffffff;
      --bg-soft:#f6f7f9;
      --card:#ffffff;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --border-soft: rgba(0,0,0,.08);
    }
    [data-theme="dark"]{
      --text:#f2f2f2;
      --muted:#adb5bd;
      --bg:#0d1117;
      --bg-soft:#0f1722;
      --card:#111827;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --border-soft: rgba(255,255,255,.08);
    }
    html,body{background:var(--bg); color:var(--text);}    
    .navbar{backdrop-filter: blur(8px);}
    .glass{background:rgba(255,255,255,.6); border:1px solid rgba(255,255,255,.5);} 
    [data-theme="dark"] .glass{background:rgba(13,17,23,.6); border:1px solid rgba(255,255,255,.08);} 

    /* Hero */
    .hero{
      background: radial-gradient(1200px 600px at 85% -20%, rgba(227,6,19,.22), transparent 60%),
                  radial-gradient(800px 400px at 10% 20%, rgba(13,110,253,.18), transparent 60%),
                  linear-gradient(180deg, var(--bg), var(--bg));
      padding-top: 7rem; padding-bottom: 4rem;
      position: relative; overflow: hidden;
    }
    .hero .badge{background: rgba(227,6,19,.1); color: var(--text); border:1px solid rgba(227,6,19,.25)}
    .blob{
      position:absolute; inset:auto -10% -20% auto; width:40rem; height:40rem; 
      background: conic-gradient(from 180deg at 50% 50%, rgba(227,6,19,.25), rgba(13,110,253,.15), transparent 65%);
      filter: blur(60px); pointer-events:none; transform: rotate(15deg);
    }

    /* Cards */
    .card{background:var(--card); border:1px solid rgba(0,0,0,.05); box-shadow: var(--shadow);} 
    .card:hover{transform: translateY(-2px); transition: .2s ease;}
    .kpi{border-radius: 1rem;}

    /* Chips */
    .chip{display:inline-flex; align-items:center; gap:.35rem; font-size:.85rem; padding:.35rem .6rem; border-radius: 999px; border: 1px solid var(--border-soft);; background:var(--bg-soft); color: var(--text);}

    /* Footer */
    footer{border-top:1px dashed rgba(0,0,0,.1);}

    /* Utilities */
    .section{padding: 4.5rem 0;}
    .avatar{width:28px; height:28px; border-radius:999px; background:linear-gradient(135deg,#e30613,#ff6b6b);} 
    .filter-pill{cursor:pointer;}
    .filter-pill.active{background:var(--brand)!important; color:#fff!important; border-color:var(--brand)!important}

    /* Dark adapt border */
    [data-theme="dark"] .card{border-color: rgba(255,255,255,.06)}
    [data-theme="dark"] footer{border-color: rgba(255,255,255,.08)}
  </style>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg sticky-top glass" style="border-bottom:1px solid rgba(0,0,0,.06)">
    <div class="container">
      <a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="#">
        <span class="avatar"></span>
        SENAI Pinda • FIC Empresa
      </a>
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-sm btn-outline-secondary" id="themeToggle" aria-label="Alternar tema"><i class="bi bi-moon-stars"></i></button>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
      <div id="nav" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-2">
          <li class="nav-item"><a class="nav-link" href="#resumo">Resumo</a></li>
          <li class="nav-item"><a class="nav-link" href="#acoes">Ações</a></li>
          <li class="nav-item"><a class="nav-link" href="#dados">Dados</a></li>
          <li class="nav-item"><a class="nav-link" href="#linha-do-tempo">Linha do tempo</a></li>
          <li class="nav-item"><a class="nav-link" href="#sobre">Sobre</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <header class="hero" id="resumo">
    <div class="container position-relative">
      <div class="row align-items-center g-4">
        <div class="col-lg-7" data-aos="fade-right">
          <span class="badge rounded-pill mb-3">Boletim mensal • Outubro/2025</span>
          <h1 class="display-5 fw-bold">FIC Empresa – <span class="text-danger">edição Outubro/2025</span></h1>
          <p class="lead text-secondary">Ações corporativas, treinamentos e parcerias do <strong>SENAI Pindamonhangaba (CFP 3.60)</strong> entre <u>28/07 e 17/10</u>.</p>
          <div class="d-flex flex-wrap gap-2 mt-3">
            <span class="chip"><i class="bi bi-building"></i> Empresas parceiras</span>
            <span class="chip"><i class="bi bi-person-gear"></i> Instrutores</span>
            <span class="chip"><i class="bi bi-people"></i> Participantes</span>
            <span class="chip"><i class="bi bi-shield-check"></i> Normas NR</span>
          </div>
        </div>
        <div class="col-lg-5" data-aos="fade-left">
          <div class="card p-4">
            <div class="row text-center g-3">
              <div class="col-4">
                <div class="kpi p-3 bg-light" id="kpi-empresas">
                  <div class="fs-4 fw-bold">–</div>
                  <div class="small text-secondary">Empresas</div>
                </div>
              </div>
              <div class="col-4">
                <div class="kpi p-3 bg-light" id="kpi-turmas">
                  <div class="fs-4 fw-bold">–</div>
                  <div class="small text-secondary">Ações</div>
                </div>
              </div>
              <div class="col-4">
                <div class="kpi p-3 bg-light" id="kpi-participantes">
                  <div class="fs-4 fw-bold">–</div>
                  <div class="small text-secondary">Participantes</div>
                </div>
              </div>
            </div>
            <hr/>
            <div class="d-flex align-items-center gap-2">
              <i class="bi bi-calendar-week text-danger"></i>
              <span class="small">Período: <strong>28/07 a 17/10/2025</strong></span>
            </div>
          </div>
        </div>
      </div>
      <div class="blob"></div>
    </div>
  </header>

  <!-- Filtros / Busca -->
  <section class="section" id="acoes">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-between gap-3 mb-3">
        <h2 class="h3 m-0">Ações e treinamentos</h2>
        <div class="d-flex gap-2 flex-wrap">
          <input id="search" class="form-control" placeholder="Buscar por empresa, curso, NR, instrutor…" style="min-width:260px"/>
          <div class="btn-group" role="group" aria-label="Filtro rápido">
            <button class="btn btn-outline-secondary filter-pill" data-filter="all">Tudo</button>
            <button class="btn btn-outline-secondary filter-pill" data-filter="NR">NR</button>
            <button class="btn btn-outline-secondary filter-pill" data-filter="Curso">Cursos</button>
            <button class="btn btn-outline-secondary filter-pill" data-filter="Evento">Eventos</button>
          </div>
        </div>
      </div>

      <div id="cards" class="row g-4"></div>

      <div class="text-center mt-4">
        <button id="btnVerMais" class="btn btn-outline-secondary d-none"><i class="bi bi-plus-lg me-1"></i>Carregar mais</button>
      </div>
    </div>
  </section>

  <!-- Dados & Gráficos -->
  <section class="section bg-body-tertiary" id="dados">
    <div class="container">
      <div class="d-flex align-items-center justify-content-between mb-3">
        <h2 class="h3 m-0">Dados consolidados</h2>
        <span class="text-secondary small">Fonte: Boletim FIC Empresa – Out/2025</span>
      </div>
      <div class="row g-4">
        <div class="col-lg-6">
          <div class="card p-3 h-100">
            <h3 class="h5">Participantes por empresa</h3>
            <canvas id="chartEmpresas" height="220" aria-label="Gráfico de barras por empresa"></canvas>
          </div>
        </div>
        <div class="col-lg-6">
          <div class="card p-3 h-100">
            <h3 class="h5">Participantes por instrutor</h3>
            <canvas id="chartInstrutores" height="220" aria-label="Gráfico de barras por instrutor"></canvas>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Linha do tempo -->
  <section class="section" id="linha-do-tempo">
    <div class="container">
      <h2 class="h3 mb-3">Linha do tempo (set – out/2025)</h2>
      <div class="swiper">
        <div class="swiper-wrapper" id="timeline"></div>
        <div class="swiper-pagination"></div>
      </div>
    </div>
  </section>

  <!-- Sobre -->
  <section class="section" id="sobre">
    <div class="container">
      <div class="row g-4">
        <div class="col-lg-7">
          <div class="card p-4 h-100">
            <h3 class="h5">Sobre o boletim</h3>
            <p>Este site reúne e apresenta, de forma dinâmica, as ações corporativas realizadas pelo <strong>SENAI Pindamonhangaba – CFP 3.60</strong> na edição de <strong>Outubro/2025</strong> do boletim FIC Empresa: cursos, treinamentos, parcerias, visitas e destaques.</p>
            <ul class="text-secondary">
              <li>Filtros, busca e cartões dinâmicos.</li>
              <li>KPIs e gráficos (Chart.js) com consolidação automática.</li>
              <li>Dark mode com persistência em <code>localStorage</code>.</li>
              <li>Hero responsivo, efeitos de scroll (AOS) e carrossel (Swiper).</li>
            </ul>
          </div>
        </div>
        <div class="col-lg-5">
          <div class="card p-4 h-100">
            <h3 class="h5">Créditos</h3>
            <ul class="list-unstyled m-0 text-secondary">
              <li class="mb-2"><i class="bi bi-building me-2 text-danger"></i>SENAI Pindamonhangaba • CFP 3.60</li>
              <li class="mb-2"><i class="bi bi-calendar3 me-2 text-danger"></i>Edição: Outubro/2025 (período 28/07–17/10)</li>
              <li class="mb-2"><i class="bi bi-shield-check me-2 text-danger"></i>Normas: NR-10, NR-11, NR-12, NR-33, NR-35, SEP</li>
              <li class="mb-2"><i class="bi bi-bar-chart-line me-2 text-danger"></i>Dashboard com Chart.js</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="py-4">
    <div class="container d-flex flex-wrap align-items-center justify-content-between gap-2">
      <div class="small text-secondary">© 2025 SENAI Pindamonhangaba • Boletim FIC Empresa (Outubro/2025)</div>
      <div class="d-flex gap-3">
        <a class="link-secondary" href="#resumo">Topo</a>
        <a class="link-secondary" href="#acoes">Ações</a>
        <a class="link-secondary" href="#dados">Dados</a>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <script>
    // ===================== Dados (extraídos do PDF) =====================
    const DATA = [
      // EDP – FIRJAN
      {tipo:'Curso', empresa:'EDP / FIRJAN', titulo:'Instalador de Sistemas Fotovoltaicos', datas:'28/07–17/10', instrutores:['Fabio da Cruz','Jonathan Lima'], participantes:13, tags:['energia','fotovoltaico']},

      // CONFAB TUBOS
      {tipo:'NR', empresa:'CONFAB TUBOS', titulo:'NR-35 Segurança em Trabalho em Altura', datas:'24–25/09', instrutores:['Alvaro Pires'], participantes:8, tags:['NR-35','segurança']},
      {tipo:'NR', empresa:'CONFAB TUBOS', titulo:'NR-35 Segurança em Trabalho em Altura', datas:'24–25/09', instrutores:['Luciano Mendes'], participantes:8, tags:['NR-35','segurança']},
      {tipo:'Curso', empresa:'CONFAB TUBOS', titulo:'Brigada de Incêndios e Emergências', datas:'26/09–03/10', instrutores:['Alvaro Pires'], participantes:14, tags:['brigada','emergência']},
      {tipo:'Curso', empresa:'CONFAB TUBOS', titulo:'Emergência e Salvamento (Altura/Espaço Confinado)', datas:'08/10', instrutores:['Alvaro Pires'], participantes:12, tags:['resgate','altura','espaço confinado']},

      // NOVELIS
      {tipo:'NR', empresa:'NOVELIS', titulo:'NR-33 Espaços Confinados', datas:'13–14/10', instrutores:['Alvaro Pires'], participantes:14, tags:['NR-33','segurança']},
      {tipo:'NR', empresa:'NOVELIS', titulo:'NR-33 Espaços Confinados', datas:'13–14/10', instrutores:['Luciano Mendes'], participantes:14, tags:['NR-33','segurança']},
      {tipo:'NR', empresa:'NOVELIS', titulo:'NR-11 Ponte Rolante – Reciclagem', datas:'16–19/09', instrutores:['Fabio da Cruz','Alvaro Pires'], participantes:2, tags:['NR-11','ponte rolante']},
      {tipo:'Curso', empresa:'NOVELIS', titulo:'Segurança no SEP e Proximidades', datas:'25/09', instrutores:['Luciano Mendes'], participantes:7, tags:['SEP','elétrica']},

      // GV do Brasil
      {tipo:'NR', empresa:'GV DO BRASIL', titulo:'NR-10 – Reciclagem', datas:'18/09', instrutores:['Jonathan Lima','Luciano Mendes'], participantes:12, tags:['NR-10','elétrica']},
      {tipo:'NR', empresa:'GV DO BRASIL', titulo:'SEP – Reciclagem', datas:'19/09', instrutores:['Jonathan Lima','Alvaro Pires'], participantes:18, tags:['SEP','elétrica']},

      // DANFOSS / NOVAMETAL
      {tipo:'Curso', empresa:'DANFOSS / NOVAMETAL', titulo:'CIPA – Comissão Interna de Prevenção de Acidentes', datas:'15–19/09', instrutores:['Jorge Apolinário','Cristiano Kanashiro'], participantes:10, tags:['CIPA','segurança']},
      {tipo:'NR', empresa:'DANFOSS / NOVAMETAL', titulo:'NR-35 Segurança em Altura', datas:'06/10', instrutores:['Claudemir Moraes'], participantes:5, tags:['NR-35','segurança']},

      // CAMPO LIMPO
      {tipo:'NR', empresa:'CAMPO LIMPO', titulo:'NR-12 Máquina Injetora (Plásticos)', datas:'11 e 15/09', instrutores:['Edison Alves'], participantes:16, tags:['NR-12','máquinas']},
      {tipo:'NR', empresa:'CAMPO LIMPO', titulo:'NR-12 Máquina Sopradora (Plásticos)', datas:'09 e 17/09', instrutores:['Edison Alves'], participantes:16, tags:['NR-12','máquinas']},
      {tipo:'NR', empresa:'CAMPO LIMPO', titulo:'NR-12 Máquina Injetora (Plásticos)', datas:'01 e 13/10', instrutores:['Edison Alves'], participantes:16, tags:['NR-12','máquinas']},
      {tipo:'NR', empresa:'CAMPO LIMPO', titulo:'NR-12 Máquina Sopradora (Plásticos)', datas:'03 e 15/10', instrutores:['Edison Alves'], participantes:16, tags:['NR-12','máquinas']},

      // SEBRAE
      {tipo:'Curso', empresa:'SEBRAE', titulo:'Fabricação de Panetones e Doces Natalinos', datas:'15–19/09', instrutores:['Giovanni Campiolo'], participantes:14, tags:['alimentos']},
      {tipo:'Curso', empresa:'SEBRAE', titulo:'Fabricação de Panetones e Doces Natalinos', datas:'15–19/09', instrutores:['Henrique Magalhães'], participantes:9, tags:['alimentos']},
      {tipo:'Curso', empresa:'SEBRAE (Qualifica Guará)', titulo:'Técnicas de Montagem de Painéis de Comandos Elétricos', datas:'03–23/10', instrutores:['Jonathan Lima','Fabio da Cruz'], participantes:11, tags:['elétrica','painéis']},

      // BASELL (evento SIPAT)
      {tipo:'Evento', empresa:'BASELL', titulo:'SIPAT – Simulações e Ações Educativas', datas:'06–09/10', instrutores:['Lucas','Giovanni'], participantes:null, tags:['SIPAT','evento']},

      // LIEBHERR (Aprendizagem)
      {tipo:'Curso', empresa:'LIEBHERR Aerospace BR', titulo:'CAI – Mecânico de Usinagem (Aprendizagem)', datas:'início 01/10', instrutores:[], participantes:16, tags:['aprendizagem','usinagem']},

      // GERDAU – Programa Aprimorar
      {tipo:'Curso', empresa:'GERDAU', titulo:'Fundamentos de Eletricidade Básica', datas:'15–16/09', instrutores:['Jonathan Lima'], participantes:13, tags:['elétrica']},
      {tipo:'Curso', empresa:'GERDAU', titulo:'Instrumentação Básica', datas:'22/09–03/10', instrutores:['Jonathan Lima'], participantes:20, tags:['instrumentação']},
      {tipo:'NR', empresa:'GERDAU', titulo:'NR-11 Operação de Empilhadeira', datas:'06–17/10', instrutores:['Jonathan Lima'], participantes:20, tags:['NR-11','logística']},

      // Destaques / Visitas / Processos
      {tipo:'Evento', empresa:'WorldSkills', titulo:'João Lucas – Ouro (Eletrônica) – Brasília', datas:'28/09', instrutores:['Pedro Jesus'], participantes:null, tags:['destaque','competição']},
      {tipo:'Evento', empresa:'GERDAU & CHB', titulo:'Visita técnica ao SENAI', datas:'30/09', instrutores:[], participantes:null, tags:['visita']},
      {tipo:'Evento', empresa:'CHB', titulo:'Processo seletivo no SENAI', datas:'06/10', instrutores:[], participants:null, tags:['seleção']},
      {tipo:'Evento', empresa:'1º BAvEx (Taubaté)', titulo:'Dia dos Professores / 39º Aniversário', datas:'25/09', instrutores:['Fabiana Ferreira'], participantes:null, tags:['cerimônia']}
    ];

    // ===================== Utilidades =====================
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => [...el.querySelectorAll(sel)];

    // Tema (dark/light)
    const setTheme = t => document.documentElement.setAttribute('data-theme', t);
    const initTheme = () => {
      const saved = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      setTheme(saved || (prefersDark ? 'dark' : 'light'));
    };

    // Formatações
    const fmtNum = n => n?.toLocaleString('pt-BR');

    // ===================== Render de Cards =====================
    const PAGE_SIZE = 9;
    let state = { query:'', filter:'all', page:1 };

    function filterData(){
      const q = state.query.trim().toLowerCase();
      return DATA.filter(item => {
        const matchesQuery = !q || [item.empresa,item.titulo,item.tipo,(item.instrutores||[]).join(' '),(item.tags||[]).join(' ')].join(' ').toLowerCase().includes(q);
        const matchesFilter = state.filter==='all' || (state.filter==='NR' && item.tipo==='NR') || (state.filter==='Curso' && item.tipo==='Curso') || (state.filter==='Evento' && item.tipo==='Evento');
        return matchesQuery && matchesFilter;
      });
    }

    function cardTemplate(item){
      const chips = [item.tipo, ...(item.tags||[])].slice(0,3).map(t=>`<span class="chip me-1">${t}</span>`).join('');
      const instr = (item.instrutores?.length? item.instrutores.join(', ') : '—');
      const participantes = (item.participantes ?? item.participants);
      return `
        <div class="col-md-6 col-lg-4">
          <div class="card h-100" data-aos="fade-up">
            <div class="card-body d-flex flex-column">
              <div class="d-flex align-items-center justify-content-between mb-2">
                <span class="badge text-bg-light border">${item.empresa}</span>
                <div>${chips}</div>
              </div>
              <h3 class="h6 mb-2">${item.titulo}</h3>
              <div class="small text-secondary mb-2"><i class="bi bi-calendar-week me-1 text-danger"></i>${item.datas}</div>
              <div class="small mb-2"><i class="bi bi-person-badge me-1 text-danger"></i><strong>Instrutores:</strong> ${instr}</div>
              <div class="mt-auto d-flex align-items-center justify-content-between">
                <span class="chip"><i class="bi bi-people me-1"></i>${participantes!=null? participantes+ ' participantes':'—'}</span>
                <button class="btn btn-sm btn-outline-danger" tabindex="0" data-bs-toggle="popover" data-bs-trigger="focus" title="Detalhes" data-bs-content="${item.empresa} • ${item.titulo}\n${item.datas}">Saiba mais</button>
              </div>
            </div>
          </div>
        </div>`;
    }

    function render(){
      const list = filterData();
      const start = 0; const end = state.page*PAGE_SIZE;
      $('#cards').innerHTML = list.slice(start,end).map(cardTemplate).join('');
      const more = list.length > end;
      $('#btnVerMais').classList.toggle('d-none', !more);
      initPopovers();
    }

    function initPopovers(){
      $$('[data-bs-toggle="popover"]').forEach(el=> new bootstrap.Popover(el));
    }

    // ===================== KPIs =====================
    function computeKPIs(){
      const empresas = new Set(DATA.map(d=>d.empresa));
      const totalAcoes = DATA.length;
      const totalPart = DATA.reduce((acc,d)=>acc + (d.participantes ?? d.participants ?? 0), 0);
      $('#kpi-empresas .fw-bold').textContent = empresas.size;
      $('#kpi-turmas .fw-bold').textContent = fmtNum(totalAcoes);
      $('#kpi-participantes .fw-bold').textContent = fmtNum(totalPart);
    }

    // ===================== Gráficos =====================
    function groupSum(arr, key){
      const map = new Map();
      arr.forEach(it=>{
        const val = (key==='instrutores' ? (it.instrutores||[]) : [it[key]]);
        const qty = (it.participantes ?? it.participants ?? 0);
        val.forEach(v=>{
          if(!v) return;
          map.set(v, (map.get(v)||0)+qty);
        })
      });
      return [...map.entries()].sort((a,b)=>b[1]-a[1]);
    }

    let chart1, chart2;
    function renderCharts(){
      const empresas = groupSum(DATA, 'empresa').slice(0,10);
      const instr = groupSum(DATA, 'instrutores').slice(0,10);

      const ctx1 = document.getElementById('chartEmpresas');
      chart1?.destroy();
      chart1 = new Chart(ctx1, {
        type:'bar',
        data:{
          labels: empresas.map(x=>x[0]),
          datasets:[{label:'Participantes', data:empresas.map(x=>x[1])}]
        },
        options:{responsive:true, maintainAspectRatio:false, scales:{y:{beginAtZero:true}}}
      });

      const ctx2 = document.getElementById('chartInstrutores');
      chart2?.destroy();
      chart2 = new Chart(ctx2, {
        type:'bar',
        data:{
          labels: instr.map(x=>x[0]),
          datasets:[{label:'Participantes', data:instr.map(x=>x[1])}]
        },
        options:{responsive:true, maintainAspectRatio:false, scales:{y:{beginAtZero:true}}}
      });
    }

    // ===================== Linha do Tempo (Swiper) =====================
    function renderTimeline(){
      const monthsOrder = ['07','08','09','10'];
      const parseKey = d => {
        // d: formatos variados, tenta capturar dd/mm e mm
        const m = d.match(/(\d{2})\/(\d{2})/);
        return m ? `${m[2]}-${m[1]}` : (d.includes('início')? '10-01' : `10-31`);
      }
      const items = DATA.map(d=>({
        ...d,
        key: parseKey(String(d.datas))
      })).sort((a,b)=>{
        const ka = a.key.split('-'); const kb = b.key.split('-');
        if(ka[0]!==kb[0]) return monthsOrder.indexOf(ka[0]) - monthsOrder.indexOf(kb[0]);
        return parseInt(ka[1]) - parseInt(kb[1]);
      });
      const el = $('#timeline');
      el.innerHTML = items.map(it=>`
        <div class="swiper-slide">
          <div class="card p-3 h-100">
            <div class="small text-secondary mb-1"><i class="bi bi-calendar2-event me-1 text-danger"></i>${it.datas}</div>
            <div class="fw-semibold">${it.titulo}</div>
            <div class="small">${it.empresa}</div>
          </div>
        </div>
      `).join('');

      new Swiper('.swiper', {
        slidesPerView: 1.2,
        spaceBetween: 16,
        breakpoints:{ 576:{slidesPerView:2}, 992:{slidesPerView:3}, 1200:{slidesPerView:4} },
        pagination:{ el: '.swiper-pagination', clickable:true }
      });
    }

    // ===================== Interações =====================
    function bindUI(){
      $('#search').addEventListener('input', (e)=>{ state.query = e.target.value; state.page=1; render(); });
      $$('.filter-pill').forEach(btn=> btn.addEventListener('click', ()=>{
        $$('.filter-pill').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        state.filter = btn.dataset.filter;
        state.page=1; render();
      }));
      $('#btnVerMais').addEventListener('click', ()=>{ state.page++; render(); });

      // Tema
      $('#themeToggle').addEventListener('click', ()=>{
        const curr = document.documentElement.getAttribute('data-theme');
        const next = curr==='dark' ? 'light' : 'dark';
        setTheme(next); localStorage.setItem('theme', next);
      });
    }

    // ===================== Boot =====================
    document.addEventListener('DOMContentLoaded', ()=>{
      initTheme();
      AOS.init({ once:true, duration:600, easing:'ease-out' });
      computeKPIs();
      bindUI();
      // Filtro inicial = Tudo
      $$('.filter-pill')[0].classList.add('active');
      render();
      renderCharts();
      renderTimeline();
    });
  </script>
</body>
</html>
